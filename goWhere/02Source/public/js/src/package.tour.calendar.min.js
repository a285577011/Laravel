!function(t){function e(){var t=this.options;a(t),l(t)}function a(){var e="",a="";for(c=0;6>c;c++){for(a+='<tr class="day">',i=1;7>=i;i++)a+=1==i||7==i?'<td id="b'+(7*c+i)+'" class="weekend"></td>':'<td id="b'+(7*c+i)+'"></td>';a+="</tr>"}e+='<div class="cal-c"><a class="cal-pre"><i class="iconfont icon-left"></i></a><span class="cal-month"></span><a class="cal-next"><i class="iconfont icon-right"></i></a></div><table class="pt-cal-warp"><tr class="weekday"><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr>'+a+"</table>",t(".pt-calendar").html(e)}function s(){var t={startDate:"2016-03-01","2016-05-22":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-05-28":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-05-29":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-06-05":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-06-13":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-06-22":{state:"0",surplus:"余票8张",price:"￥8869起"},"2016-07-13":{state:"0",surplus:"余票8张",price:"￥8869起"}};return t}function l(t){var e=t.data;h=new Date,p=e;var a=h.getFullYear(),s=h.getMonth();showmm=s+1,n(a,showmm,t,"1")}function n(t,e,a,s){if(cury=t,curm=e,13==e&&(curm=1,cury=t+1),startdate=cury+(curm>9?"-"+curm:"-0"+curm)+"-01",null==s&&(p=a.data),10!=startdate.length){var l=startdate.split("-"),n=[];if(3==l.length)for(var c=0,i=l.length;i>c;c++)2==l[c].length||4==l[c].length?n.push(l[c]):1==l[c].length&&n.push("0"+l[c]);startdate=n.join("-")}d=t,g=e,r(t,e-1,"b",p,a)}function r(e,a,s,l,r,c){var i=r.showMaxMonth-1;e>m.getFullYear()||e==m.getFullYear()&&a>=m.getMonth()+1?t(".cal-pre").off("click").on("click",function(){n(u,o,r)}).addClass("clickAble"):t(".cal-pre").off("click").removeClass("clickAble"),e==m.getFullYear()&&a>=m.getMonth()+i||e>m.getFullYear()&&Math.abs(m.getMonth()+1-a)%12<=i?t(".cal-next").off("click").removeClass("clickAble"):t(".cal-next").off("click").on("click",function(){n(u,o+2,r)}).addClass("clickAble");var p=new Date(e,a,1),h=p.getFullYear(),d=p.getMonth()+1;if(0==d&&(d=12,h=new Date(e-1,a,1).getFullYear()),t(".cal-month").text(h+"年"+(d>9?d:"0"+d)+"月"),null!=c){var g=c.split("-");c=new Date(parseInt(g[0],10),parseInt(g[1]-1,10),parseInt(g[2]-1),10)}else c=m;var f;f=m.getTime()<c.getTime()?c:m;var w=new Date(e,a,1),v=new Array,M=w.getDay(),b=w.getDate();u=w.getFullYear(),o=w.getMonth();for(var y=1;M>=y;y++)de=document.getElementById(s+y),de.innerHTML="",de.bgColor="";for(showm=o+1,showprice="",priceHtml="",febclass="";w.getMonth()==o;){if(de=document.getElementById(s+(b+M)),showFulldate=u+"-"+(showm>9?showm:"0"+showm)+"-"+(b>9?b:"0"+b),showdate=b>9?b:"0"+b,priceHtml="",surplusHtml="",l&&l[showFulldate]){if(l[showFulldate].price){var F=l[showFulldate].price;v[F]?v[F].push(s+(b+M)):v[F]=[s+(b+M)],priceHtml+=F}if(l[showFulldate].surplus){var H=l[showFulldate].surplus;v[H]?v[H].push(s+(b+M)):v[H]=[s+(b+M)],surplusHtml+=H}}w.getFullYear()==m.getFullYear()&&w.getMonth()==m.getMonth()&&w.getDate()==m.getDate()?surplusHtml?de.innerHTML='<a class="cal_link" style="display:block;height:100%" data-begin="'+showFulldate+'"><span class="date" style="color: #3baae3">今天</span><span class="surplus">'+surplusHtml+'</span><span class="cal-price">'+priceHtml+"</span></a>":de.innerHTML='<span class="date" style="color: #3baae3">今天</span>':w.getTime()<f.getTime()?de.innerHTML='<span class="date">'+showdate+"</span>":surplusHtml?de.innerHTML='<a class="cal_link" style="display:block;height:100%" data-begin="'+showFulldate+'"><span class="date">'+showdate+'</span><span class="surplus">'+surplusHtml+'</span><span class="cal-price"> '+priceHtml+"</span></a>":de.innerHTML='<span class="date">'+showdate+"</span>",w.setDate(++b)}for(;42>=b+M;)de=document.getElementById(s+(b+M)),de.innerHTML="<span class='Noprice'>&nbsp;</span>",b++}var c,i,u,o,p,h,d="",g="",m=new Date,f=function(e,a){this.$element=e,this.defaults={showMaxMonth:6,data:s()},this.options=t.extend({},this.defaults,a)};f.prototype={calendarInit:e},t.fn.ptCal=function(t){var e=new f(this,t);return e.calendarInit()}}(jQuery);